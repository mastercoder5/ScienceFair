<!DOCTYPE html>
<html>
<head>
  <title>Assessment</title>
  <style>
    body {
      margin: 0;
      padding: 40px;
      padding-bottom: 100px; 
      font-family: "Arial", sans-serif;
      background: #f4f4f4;
      color: #222;
    }

    .container {
      max-width: 800px;
      margin: auto;
      background: #ffffff;
      padding: 30px;
      border-radius: 6px;
      border: 1px solid #dcdcdc;
    }

    h1, h2 {
      text-align: center;
      font-weight: 600;
      color: #222;
    }

    h1 {
      font-size: 28px;
      margin-bottom: 20px;
    }

    h2 {
      font-size: 20px;
      margin-bottom: 15px;
      padding-bottom: 5px;
      border-bottom: 1px solid #e0e0e0;
    }

    .question-card {
      display: none;
      padding: 20px;
      background: #fafafa;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      margin-bottom: 20px;
      position: relative;
    }

    .flag-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #eee;
      border: 1px solid #ccc;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.2s;
    }

    .flag-btn.flagged {
      background: #ffeb3b;
      border-color: #fbc02d;
      font-weight: bold;
    }

    .options label {
      display: block;
      margin-top: 8px;
      cursor: pointer;
    }

    .nav-buttons {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #ffffff;
      padding: 15px 0;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      border-top: 1px solid #dcdcdc;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
      z-index: 999;
    }

    button {
      padding: 10px 22px;
      font-size: 16px;
      border: 1px solid #888;
      border-radius: 4px;
      background: #e9e9e9;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background: #dcdcdc;
    }

    #questionsPopup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      background: white;
      border: 2px solid #333;
      border-radius: 8px;
      padding: 20px;
      z-index: 10001;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }

    .popup-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-top: 15px;
    }

    .popup-box {
      aspect-ratio: 1/1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid #ccc;
    }

    .box-green { background-color: #d4edda; }
    .box-red { background-color: #f8d7da; }
    .box-yellow { background-color: #fff3cd; border: 2px solid #fbc02d; }

    #closePopup {
      float: right;
      cursor: pointer;
      font-weight: bold;
      font-size: 20px;
    }

    #reviewScreen { display: none; text-align: center; }
    .review-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px; margin: 20px 0; }
    .review-box { width: 100%; aspect-ratio: 1 / 1; display: flex; align-items: center; justify-content: center; font-weight: bold; border-radius: 4px; border: 1px solid #ccc; cursor: pointer; }

    #resultsScreen { display: none; text-align: center; padding: 40px; }
    #finalScore { font-size: 24px; margin-top: 20px; font-weight: bold; color: #333; }
    #percentGrade { font-size: 32px; margin-top: 10px; color: #007bff; font-weight: bold; }
    #finalTime { font-size: 18px; margin-top: 10px; color: #666; }
    #startScreen { text-align: center; padding: 40px; }
    #startScreen p { font-size: 18px; line-height: 1.6; color: #333; }

    #notesWindow { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 500px; height: 350px; background: #ffffff; border: 1px solid #ccc; border-radius: 6px; padding: 15px; z-index: 9999; }
    #notesWindow textarea { width: 100%; height: 260px; resize: none; font-size: 16px; padding: 10px; border: 1px solid #ccc; }
    #closeNotes { float: right; cursor: pointer; font-size: 20px; font-weight: bold; color: #444; }

    #annotationCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10000; cursor: crosshair; }
    .annotation-toolbar { position: fixed; top: 12px; right: 12px; background: rgba(255,255,255,0.95); border: 1px solid #ccc; padding: 8px; border-radius: 6px; z-index: 10001; display: none; align-items: center; gap: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
  </style>
</head>

<body>

<div id="startScreen" class="container">
  <h1>Assessment Instructions</h1>
  <p>
    This assessment includes:<br><br>
    ‚Ä¢ 7th Grade Science<br>
    ‚Ä¢ 8th Grade Mathematics<br>
    ‚Ä¢ 8th Grade Language Arts (ILA)<br><br>
    The assessment will open in fullscreen mode.<br>
    If you exit fullscreen at any time, your progress will be erased.
  </p>
  <button onclick="startQuiz()">Start Assessment</button>
</div>

<div id="quizScreen" class="container" style="display:none;">
  <h1>Assessment</h1>
  <div id="questionContainer"></div>
  <div class="nav-buttons">
    <button id="prevBtn" onclick="prevQuestion()">‚Üê Previous</button>
    <button onclick="openPopup()">Questions</button>
    <button id="openNotesBtn" onclick="openNotes()">Notes</button>
    <button id="annotateBtn" onclick="toggleAnnotate()">Annotate</button>
    <button id="nextBtn" onclick="nextQuestion()">Next ‚Üí</button>
    <button id="submitBtn" onclick="goToReview()" style="display:none; background-color: #e2e3e5;">Review & Submit</button>
  </div>
</div>

<div id="questionsPopup">
  <span id="closePopup" onclick="closePopup()">‚úñ</span>
  <h3 style="margin-top:0;">Question Review</h3>
  <div id="popupGrid" class="popup-grid"></div>
</div>

<div id="reviewScreen" class="container">
  <h1>Review Your Assessment</h1>
  <p>Check your answers before final submission. Click a box to go back to that question.</p>
  <div id="reviewGrid" class="review-grid"></div>
  <div style="margin-top: 20px;">
    <button onclick="backToQuiz()" style="margin-right: 10px;">Back to Questions</button>
    <button id="finalSubmitBtn" onclick="submitQuiz()" style="background-color: #d4edda; font-weight: bold;">Final Submit Assessment</button>
  </div>
</div>

<div id="resultsScreen" class="container">
  <h1>Assessment Results</h1>
  <p id="finalScore"></p>
  <p id="percentGrade"></p>
  <p id="finalTime"></p>
</div>

<div id="notesWindow">
  <span id="closeNotes" onclick="closeNotes()">‚úñ</span>
  <h2 style="text-align:center;">Notes</h2>
  <textarea id="notesArea" oninput="saveNotes()"></textarea>
</div>

<canvas id="annotationCanvas"></canvas>
<div class="annotation-toolbar" id="annotationToolbar">
  <label style="font-size:13px;">Color</label>
  <input type="color" id="annoColor" value="#ff0000">
  <label style="font-size:13px;">Size</label>
  <input type="range" id="annoSize" min="1" max="40" value="4">
  <button id="annoClear">Clear</button>
  <button id="annoSave">Save</button>
  <button id="annoClose">Exit</button>
</div>

<script>
let startTime; 

function openNotes() { document.getElementById("notesWindow").style.display = "block"; document.getElementById("notesArea").value = localStorage.getItem("quizNotes") || ""; }
function closeNotes() { document.getElementById("notesWindow").style.display = "none"; }
function saveNotes() { localStorage.setItem("quizNotes", document.getElementById("notesArea").value); }

const questions = [
  { section: "7th Grade Science", q: "Which state of matter has a definite volume but no definite shape?", o: ["Plasma","Liquid","Gas","Solid"], a: 1 },
  { section: "7th Grade Science", q: "What force pulls objects toward Earth?", o: ["Electricity","Friction","Magnetism","Gravity"], a: 3 },
  { section: "7th Grade Science", q: "Which organ system transports blood throughout the body?", o: ["Circulatory","Digestive","Nervous","Respiratory"], a: 0 },
  { section: "7th Grade Science", q: "What is the main source of energy for Earth's weather?", o: ["The oceans","The Moon","Earth's core","The Sun"], a: 3 },
  { section: "7th Grade Science", q: "Which is an example of a physical change?", o: ["Baking a cake","Burning wood","Rusting metal","Melting ice"], a: 3 },
  { section: "7th Grade Science", q: "What do we call an organism that makes its own food?", o: ["Decomposer","Predator","Producer","Consumer"], a: 2 },
  { section: "7th Grade Science", q: "Which tool measures temperature?", o: ["Balance","Thermometer","Graduated cylinder","Ruler"], a: 1 },
  { section: "7th Grade Science", q: "What is the term for water vapor turning into liquid water?", o: ["Precipitation","Evaporation","Sublimation","Condensation"], a: 3 },
  { section: "7th Grade Science", q: "Which of the following is a renewable resource?", o: ["Oil","Solar energy","Natural gas","Coal"], a: 1 },
  { section: "7th Grade Science", q: "What is the basic unit of life?", o: ["Tissue","Cell","Atom","Organ"], a: 1 },
  { section: "8th Grade Mathematics", q: "What is the value of 5x - 7 when x = 3?", o: ["7","8","15","10"], a: 1 },
  { section: "8th Grade Mathematics", q: "Which expression is equivalent to 3(x + 4)?", o: ["3x + 12","3x + 4","3x + 7","x + 12"], a: 0 },
  { section: "8th Grade Mathematics", q: "What is the slope of a line that rises 4 units for every 2 units it runs?", o: ["4","1/2","1","2"], a: 3 },
  { section: "8th Grade Mathematics", q: "Solve: 2y + 6 = 18", o: ["8","12","4","6"], a: 3 },
  { section: "8th Grade Mathematics", q: "Which number is rational?", o: ["0.75","‚àö2","œÄ","0.1010010001..."], a: 0 },
  { section: "8th Grade Mathematics", q: "What is the area of a rectangle with length 9 and width 4?", o: ["36","45","13","18"], a: 0 },
  { section: "8th Grade Mathematics", q: "Which inequality represents 'a number n is greater than 12'?", o: ["n > 12","n ‚â• 12","n < 12","n ‚â§ 12"], a: 0 },
  { section: "8th Grade Mathematics", q: "What is 7¬≤?", o: ["21","77","14","49"], a: 3 },
  { section: "8th Grade Mathematics", q: "Which of the following is a linear function?", o: ["y = ‚àöx","y = x¬≤","y = 2/x","y = 3x + 1"], a: 3 },
  { section: "8th Grade Mathematics", q: "What is the mean of 4, 8, 10, and 2?", o: ["8","6","4","5"], a: 1 },
  { section: "8th Grade Language Arts (ILA)", q: "Which sentence uses correct punctuation for a compound sentence?", o: ["I wanted to go to the park, but it started raining.", "I wanted to go to the park but, it started raining.", "I wanted to go to the park but it started raining.", "I wanted to go to the park; but it started raining."], a: 0 },
  { section: "8th Grade Language Arts (ILA)", q: "What is the theme of a story?", o: ["The main character","The time and place","The lesson or message","A problem in the story"], a: 2 },
  { section: "8th Grade Language Arts (ILA)", q: "Which word is a synonym for 'reluctant'?", o: ["Certain","Eager","Unwilling","Joyful"], a: 2 },
  { section: "8th Grade Language Arts (ILA)", q: "Which sentence is written in active voice?", o: ["The ball was thrown by Maria.","Maria threw the ball.","The ball was being thrown.","The ball had been thrown."], a: 1 },
  { section: "8th Grade Language Arts (ILA)", q: "Which point of view uses 'I' and 'me'?", o: ["Third person limited","Second person","Third person omniscient","First person"], a: 3 },
  { section: "8th Grade Language Arts (ILA)", q: "Which sentence contains a simile?", o: ["The clouds danced across the sky.","The classroom was a zoo.","Her smile was sunshine.","He ran like the wind."], a: 3 },
  { section: "8th Grade Language Arts (ILA)", q: "What is the main idea of a paragraph?", o: ["A small detail","The central point","A character‚Äôs opinion","A random fact"], a: 1 },
  { section: "8th Grade Language Arts (ILA)", q: "Which transition word shows contrast?", o: ["Next","Therefore","However","Finally"], a: 2 },
  { section: "8th Grade Language Arts (ILA)", q: "Which sentence is written correctly?", o: ["It's been a long day.","Its going to rain today.","The dog wagged it's tail.","Its' time to go."], a: 0 },
  { section: "8th Grade Language Arts (ILA)", q: "Which word is an antonym for 'scarce'?", o: ["Limited","Rare","Plentiful","Few"], a: 2 }
];

const container = document.getElementById("questionContainer");
const flaggedStatus = new Array(questions.length).fill(false);

questions.forEach((item, index) => {
  let card = document.createElement("div");
  card.className = "question-card";
  card.id = "q" + index;
  let html = `<button class="flag-btn" id="flagBtn${index}" onclick="toggleFlag(${index})">Flag üö©</button><h2>${item.section}</h2><p><strong>${index + 1}. ${item.q}</strong></p><div class="options">`;
  item.o.forEach((opt, i) => { html += `<label><input type='radio' name='q${index}' value='${i}'> ${opt}</label>`; });
  html += `</div>`;
  card.innerHTML = html;
  container.appendChild(card);
});

function toggleFlag(index) {
  flaggedStatus[index] = !flaggedStatus[index];
  const btn = document.getElementById("flagBtn" + index);
  btn.classList.toggle('flagged');
  btn.innerText = flaggedStatus[index] ? "Flagged üö©" : "Flag üö©";
}

let current = 0;
function showQuestion(n) {
  closePopup();
  document.querySelectorAll(".question-card").forEach(card => card.style.display = "none");
  document.getElementById("reviewScreen").style.display = "none";
  document.getElementById("quizScreen").style.display = "block";
  document.getElementById("q" + n).style.display = "block";
  document.getElementById("prevBtn").style.display = n === 0 ? "none" : "inline-block";
  document.getElementById("nextBtn").style.display = n === questions.length - 1 ? "none" : "inline-block";
  document.getElementById("submitBtn").style.display = n === questions.length - 1 ? "inline-block" : "none";
  current = n;
}

function nextQuestion() { if (current < questions.length - 1) { current++; showQuestion(current); } }
function prevQuestion() { if (current > 0) { current--; showQuestion(current); } }

function openPopup() {
  const grid = document.getElementById("popupGrid");
  grid.innerHTML = "";
  questions.forEach((_, index) => {
    const isAnswered = document.querySelector(`input[name='q${index}']:checked`);
    const box = document.createElement("div");
    box.className = "popup-box " + (flaggedStatus[index] ? "box-yellow" : (isAnswered ? "box-green" : "box-red"));
    box.innerText = index + 1;
    box.onclick = () => showQuestion(index);
    grid.appendChild(box);
  });
  document.getElementById("questionsPopup").style.display = "block";
}
function closePopup() { document.getElementById("questionsPopup").style.display = "none"; }

function startQuiz() { 
  document.getElementById("startScreen").style.display = "none"; 
  document.getElementById("quizScreen").style.display = "block"; 
  startTime = Date.now(); 
  showQuestion(0); 
  enterFullscreen(); 
}

function enterFullscreen() { const elem = document.documentElement; if (elem.requestFullscreen) elem.requestFullscreen(); else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen(); else if (elem.msRequestFullscreen) elem.msRequestFullscreen(); }
document.addEventListener("fullscreenchange", () => { if (!document.fullscreenElement) resetQuiz(); });

function resetQuiz() {
  document.querySelectorAll("input[type=radio]").forEach(r => r.checked = false);
  document.querySelectorAll(".flag-btn").forEach((btn, idx) => { flaggedStatus[idx] = false; btn.classList.remove('flagged'); btn.innerText = "Flag üö©"; });
  localStorage.removeItem("quizNotes");
  document.getElementById("quizScreen").style.display = "none";
  document.getElementById("reviewScreen").style.display = "none";
  document.getElementById("resultsScreen").style.display = "none";
  document.getElementById("startScreen").style.display = "block";
}

function goToReview() {
  document.getElementById("quizScreen").style.display = "none";
  document.getElementById("reviewScreen").style.display = "block";
  const grid = document.getElementById("reviewGrid");
  grid.innerHTML = "";
  questions.forEach((_, index) => {
    const isAnswered = document.querySelector(`input[name='q${index}']:checked`);
    const box = document.createElement("div");
    box.className = "review-box " + (flaggedStatus[index] ? "box-yellow" : (isAnswered ? "box-green" : "box-red"));
    box.innerText = index + 1;
    box.onclick = () => showQuestion(index);
    grid.appendChild(box);
  });
}

function backToQuiz() { showQuestion(current); }
function submitQuiz() {
  let score = 0;
  const endTime = Date.now();
  const timeTaken = Math.floor((endTime - startTime) / 1000);
  const minutes = Math.floor(timeTaken / 60);
  const seconds = timeTaken % 60;

  questions.forEach((item, index) => {
    const selected = document.querySelector(`input[name='q${index}']:checked`);
    if (selected && Number(selected.value) === item.a) score++;
  });

  const percentage = Math.round((score / questions.length) * 100);

  document.getElementById("reviewScreen").style.display = "none";
  document.getElementById("resultsScreen").style.display = "block";
  document.getElementById("finalScore").innerText = "Score: " + score + " out of " + questions.length;
  document.getElementById("percentGrade").innerText = percentage + "%";
  document.getElementById("finalTime").innerText = "Time Taken: " + minutes + "m " + seconds + "s";
}

let annoEnabled = false;
const canvas = document.getElementById('annotationCanvas');
const toolbar = document.getElementById('annotationToolbar');
const colorInput = document.getElementById('annoColor');
const sizeInput = document.getElementById('annoSize');
const ctx = canvas.getContext('2d');
function setupCanvas(){ const ratio = window.devicePixelRatio || 1; canvas.width = window.innerWidth * ratio; canvas.height = window.innerHeight * ratio; canvas.style.width = window.innerWidth + 'px'; canvas.style.height = window.innerHeight + 'px'; ctx.scale(ratio, ratio); ctx.lineJoin = 'round'; ctx.lineCap = 'round'; }
window.addEventListener('resize', setupCanvas);
setupCanvas();
let drawing = false;
function getPointerPos(e){ return { x: e.clientX || (e.touches && e.touches[0].clientX), y: e.clientY || (e.touches && e.touches[0].clientY) }; }
canvas.addEventListener('pointerdown', (e) => { if (!annoEnabled) return; drawing = true; const pos = getPointerPos(e); ctx.beginPath(); ctx.moveTo(pos.x, pos.y); e.preventDefault(); });
canvas.addEventListener('pointermove', (e) => { if (!drawing || !annoEnabled) return; const pos = getPointerPos(e); ctx.strokeStyle = colorInput.value; ctx.lineWidth = sizeInput.value; ctx.lineTo(pos.x, pos.y); ctx.stroke(); e.preventDefault(); });
canvas.addEventListener('pointerup', () => { drawing = false; });
function toggleAnnotate(){
  annoEnabled = !annoEnabled;
  canvas.style.pointerEvents = annoEnabled ? 'auto' : 'none';
  toolbar.style.display = annoEnabled ? 'flex' : 'none';
  document.getElementById('annotateBtn').innerText = annoEnabled ? 'Exit Annotate' : 'Annotate';
}
document.getElementById('annoClear').addEventListener('click', () => { ctx.clearRect(0,0,canvas.width,canvas.height); });
document.getElementById('annoSave').addEventListener('click', () => { const data = canvas.toDataURL('image/png'); const a = document.createElement('a'); a.href = data; a.download = 'annotation.png'; a.click(); });
document.getElementById('annoClose').addEventListener('click', () => { if (annoEnabled) toggleAnnotate(); });
</script>
</body>
</html>